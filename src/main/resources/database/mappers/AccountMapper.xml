<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

  <mapper namespace="com.winter.app.accounts.AccountDAO">
  	<insert id="add" parameterType="AccountDTO">
  		INSERT INTO ACCOUNT (ACCOUNTNUMBER, BOOKNUMBER, USERNAME, ACCOUNTDATE, ACCOUNTBALANCE)
  		VALUES(#{accountNumber}, #{bookNumber}, #{userName}, SYSDATE, 0)
  	</insert>
  	
  	<select id="detail" parameterType="AccountDTO" resultMap="detailResult">
  		SELECT A.*, B.*
		FROM ACCOUNT A
			 INNER JOIN
			 BANKBOOK B
			 ON A.BOOKNUMBER = B.BOOKNUMBER
		WHERE A.ACCOUNTNUMBER=#{accountNumber}
  	
  	</select>
  	
  	<resultMap type="AccountDTO" id="detailResult">
  		<id column="ACCOUNTNUMBER" property="accountNumber"/>
  		<result column="BOOKNUMBER" property="bookNumber"/>
  		<result column="ACCOUNTDATE" property="accountDate"/>
  		<result column="ACCOUNTBALANCE" property="accountBalance"/>
  		<!-- 1:1 -->
  		<association property="productDTO" javaType="ProductDTO" >
  			<result column="BOOKNAME" property="bookName"/>
  			<result column="BOOKRATE" property="bookRate"/>
  		</association>
  	
  	</resultMap>
	
  	
  </mapper>